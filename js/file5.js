var searchword,keywords,tabUrl,pdfsitenumber,resivedurl,run=0,myobj=document.getElementById("loadcss");myobj.remove();function getCookie(a){a=("; "+document.cookie).split("; "+a+"=");if(2==a.length)return a.pop().split(";").shift()}function checkhttp(){xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){}}function mysearch(){searchword=prompt("Please enter search term:","")}
function myadd(){tabUrl=prompt("Please enter the page url:","");if(!(null==tabUrl||""==tabUrl))if(keywords=prompt("Please write some keywords for the page:",""),!(null==keywords||""==keywords))if(rating=prompt("Please give the page a rating (from 1-10) default:1",""),null==rating||""==rating)rating=1}
function sendcookierequest(){resivedurl=[];try{(resivedurl=JSON.parse(decodeURIComponent(getCookie("acookie"))))&&getUrl()}catch(a){window.open("http://127.0.0.1:8081/login/main_login.php")}}
function getUrl(){run?console.log("Already running"):(run=1,checkhttp(),xmlhttp.open("GET","http://127.0.0.1:8081/search_plugin.php?url="+encodeURIComponent(searchword),!1),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmlhttp.send(),sendcookierequest(),url=resivedurl[0],url.includes("http")?window.open(resivedurl[0]):window.open("https://"+resivedurl[0]));run=0}
function sendCurrentUrl(){checkhttp();if(pdfsitenumber)tabUrl=pdfurl,a=pdfsitenumber;else var a=1;xmlhttp.open("GET","http://127.0.0.1:8081/foobar_submit.php?url="+encodeURIComponent(tabUrl)+"&keywords="+encodeURIComponent(keywords)+"&rating="+encodeURIComponent(rating)+"&pagenumber="+encodeURIComponent(a),!0);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.timeout=5E3;xmlhttp.send()}document.getElementById("searcher").addEventListener("click",klicksearch);
document.getElementById("adder").addEventListener("click",klickadd);function klickadd(){myadd();keywords&&sendCurrentUrl()}function klicksearch(){mysearch();searchword&&getUrl()}document.addEventListener("keypress",eventKey);function eventKey(a){"Digit1"==a.code&&(mysearch(),searchword&&getUrl())};
